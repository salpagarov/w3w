# w3w

## Сеть

### L1

- список соединений по IP:port
- пакет - двичный блок данных
- очереди (входящая и исходящая) для отправки и получения пакета

*Отправлять по всем соединениям сразу лучше для разделения по сетевым уровням, потому что не нужно вводить сущность w3w-адреса на первом уровне или пробрасывать сущность ip-адреса на второй. Но плохо с точки зрения избыточности трафика. Надо думать.*

### L2

- w3w-адрес - уникальный идентификатор с нормальным распределением (например, `hash(UUID)`)
- соседи - литерально упорядоченный список адресов известных узлов, замкнутый в кольцо
- сообщение - пакет с адресом получателя в первых байтах

Логика простроения сети следующая - они накапливаются в кольцо до определенного предела. Если предел равен 10, то после добавления 11-го узла выбирается один из существующих и передается его соседям "слева" и "справа", а сам он из кольца удаляется. Все узлы ведут себя подобным образом и по мере добавления узлов они будут самоорганизавываться в пересекающиеся звезды. 

В полученной сети для отправки сообщения по любому адресу достаточно отправить ее соседям "справа" и "слева" от получателя. Те сделают то же самое и в конечном итогде сообщение будет доставлено. Отправлять можно и несуществующим адресам - тогда оно останется на двух ближайших к получателю узлах и либо будет сброшено после завершения времени жизни, либо доставлены, когда он появится. 

### L3

Чтобы разместить большой файл в сети, необходимо разбить его на фрагменты. Каждый фрагмент отправить по адресу, равному хэшу файла. Каждый следующий фрагмент должен содержать хэш предыдущего (как в блокчейне), а последний ссылаться на нулевое значение.

После отправки большого файла он будет разбросан совершенно произвольным образом по узлам сети, а для его получения необходимо знать только хэш первого сообщения в цепочке. 

Все файлы будут хранится в распределенной сети с коэффициентом дублирования равным 2. Для увеличения этого коэффициента можно использовать не по одному соседу, а по два, три...
